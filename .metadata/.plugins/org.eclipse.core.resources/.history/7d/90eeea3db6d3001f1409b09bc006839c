import java.io.DataInput;
import java.io.DataOutput;
import java.io.IOException;
import org.apache.hadoop.io.Writable;

public class PointWritable implements Writable {
   private float[] attributes = null;
   private int dim;
   private int nPoints;

   public PointWritable() {
      this.dim = 0;
   }

   public PointWritable(float[] c) {
      this.set(c);
   }

   public PointWritable(String[] s) {
      this.set(s);
   }

   public static PointWritable copy(PointWritable p) {
      PointWritable ret = new PointWritable(p.attributes);
      ret.nPoints = p.nPoints;
      return ret;
   }

   public void set(float[] c) {
      this.attributes = c;
      this.dim = c.length;
      this.nPoints = 1;
   }

   public void set(String[] s) {
      this.attributes = new float[s.length];
      this.dim = s.length;
      this.nPoints = 1;

      for(int i = 0; i < s.length; ++i) {
         this.attributes[i] = Float.parseFloat(s[i]);
      }

   }

   public void readFields(DataInput in) throws IOException {
      this.dim = in.readInt();
      this.nPoints = in.readInt();
      this.attributes = new float[this.dim];

      for(int i = 0; i < this.dim; ++i) {
         this.attributes[i] = in.readFloat();
      }

   }

   public void write(DataOutput out) throws IOException {
      out.writeInt(this.dim);
      out.writeInt(this.nPoints);

      for(int i = 0; i < this.dim; ++i) {
         out.writeFloat(this.attributes[i]);
      }

   }

   public String toString() {
      StringBuilder point = new StringBuilder();

      for(int i = 0; i < this.dim; ++i) {
         point.append(Float.toString(this.attributes[i]));
         if (i != this.dim - 1) {
            point.append(",");
         }
      }

      return point.toString();
   }

   public void sum(PointWritable p) {
      for(int i = 0; i < this.dim; ++i) {
         float[] var10000 = this.attributes;
         var10000[i] += p.attributes[i];
      }

      this.nPoints += p.nPoints;
   }

   //
   public double calcDistance(PointWritable p) {
      double dist = 0.0D;

      for(int i = 0; i < this.dim; ++i) {
         dist += Math.pow((double)Math.abs(this.attributes[i] - p.attributes[i]), 2.0D);
      }

      dist = Math.sqrt(dist);
      return dist;
   }

   public void calcAverage() {
      for(int i = 0; i < this.dim; ++i) {
         float temp = this.attributes[i] / (float)this.nPoints;
         this.attributes[i] = (float)Math.round(temp * 100000.0F) / 100000.0F;
      }

      this.nPoints = 1;
   }
}